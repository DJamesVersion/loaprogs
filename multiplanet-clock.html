<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Multiplanet Live Clock</title>
  <style>
    :root{
      --bg:#0b1020; --card:#0f1724; --accent:#66d9ef; --muted:#9aa7b2; --glass:rgba(255,255,255,0.02);
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      color: #e6eef6;
    }
    html,body{height:100%;margin:0;background:linear-gradient(180deg,#071027 0%, #071827 60%);display:flex;align-items:center;justify-content:center;}
    .wrap{width:980px;max-width:96vw;padding:28px;border-radius:14px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));box-shadow: 0 8px 30px rgba(2,6,23,0.6);}
    header{display:flex;justify-content:space-between;align-items:center;margin-bottom:18px}
    h1{font-size:20px;margin:0;color:var(--accent);letter-spacing:0.4px}
    .controls{display:flex;gap:10px;align-items:center}
    .toggle{display:inline-flex;align-items:center;gap:8px;color:var(--muted);font-size:13px}
    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
    .tile{background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.015));border-radius:10px;padding:14px;border:1px solid rgba(255,255,255,0.03);min-height:110px;display:flex;flex-direction:column;justify-content:space-between}
    .row{display:flex;justify-content:space-between;align-items:center}
    .planet{font-weight:700;font-size:16px;color:#dff6fb}
    .time{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", monospace; font-size:28px; letter-spacing:0.6px; margin-top:6px}
    .meta{font-size:12px;color:var(--muted);margin-top:8px;display:flex;justify-content:space-between;gap:8px}
    .muted{color:var(--muted);font-size:13px}
    .small{font-size:12px;color:var(--muted)}
    .footer{margin-top:14px;color:var(--muted);font-size:13px;display:flex;justify-content:space-between;align-items:center}
    .epoch-select{background:var(--glass);border:1px solid rgba(255,255,255,0.03);padding:6px 8px;border-radius:8px;color:var(--muted)}
    .chip{background:rgba(255,255,255,0.02);padding:6px 10px;border-radius:999px;font-size:13px;border:1px solid rgba(255,255,255,0.03)}
    @media (max-width:720px){ .grid{grid-template-columns:repeat(1,1fr)} .wrap{padding:16px} .time{font-size:24px} }
  </style>
</head>
<body>
  <div class="wrap" role="application" aria-label="Multiplanet live clock">
    <header>
      <h1>Multiplanet Live Clock</h1>
      <div class="controls">
        <label class="toggle">
          <input id="nativeToggle" type="checkbox" />
          <span class="small">Native hours</span>
        </label>
        <select id="epoch" class="epoch-select" title="Epoch">
          <option value="unix">Unix epoch (1970-01-01)</option>
          <option value="j2000">J2000 (2000-01-01T12:00:00Z)</option>
        </select>
      </div>
    </header>

    <div class="grid" id="grid">
      <!-- tiles inserted by JS -->
    </div>

    <div class="footer">
      <div class="muted">All times are computed from selected epoch and current UTC</div>
      <div class="chip" id="utcNow">UTC now</div>
    </div>
  </div>

  <script>
  // Mean local day lengths in Earth seconds (working defaults)
  const BODIES = [
    {id:'earth', name:'Earth', D:86400.0, note:'Mean solar day'},
    {id:'mars', name:'Mars', D:88775.244, note:'Mars sol (mean solar day)'},
    {id:'venus', name:'Venus', D:116.75 * 86400.0, note:'Approx mean solar day'},
    {id:'titan', name:'Titan', D:15.945 * 86400.0, note:'Approx rotation/orbital day'},
    {id:'haumea', name:'Haumea', D:3.9155 * 3600.0, note:'Rotation period (sidereal)'}
  ];

  // Epochs (ms since unix epoch)
  const EPOCHS = {
    'unix': 0,
    // J2000: 2000-01-01T12:00:00Z in ms relative to Unix epoch
    'j2000': Date.UTC(2000,0,1,12,0,0)
  };

  const grid = document.getElementById('grid');
  const nativeToggle = document.getElementById('nativeToggle');
  const epochSelect  = document.getElementById('epoch');
  const utcNowLabel = document.getElementById('utcNow');

  // Build tiles
  BODIES.forEach(b=>{
    const tile = document.createElement('div');
    tile.className = 'tile';
    tile.id = 'tile-' + b.id;
    tile.innerHTML = `
      <div>
        <div class="row">
          <div class="planet">${b.name}</div>
          <div class="small">${b.note}</div>
        </div>
        <div class="time" id="${b.id}-time">--:--:--</div>
        <div class="meta">
          <div class="small" id="${b.id}-day">day --</div>
          <div class="small" id="${b.id}-D">D=${(b.D/3600).toFixed(3)}h</div>
        </div>
      </div>
    `;
    grid.appendChild(tile);
  });

  function pad(n, len=2){ return String(n).padStart(len,'0'); }

  function computeLocal(t_ms, epoch_ms, D_seconds){
    const elapsed_s = (t_ms - epoch_ms) / 1000.0;
    // day count and fractional day (keep negative handling)
    const day_count = Math.floor(Math.floor(elapsed_s) / D_seconds);
    let frac = ((elapsed_s / D_seconds) % 1 + 1) % 1;
    return { day_count, frac };
  }

  function fracToHMS(frac, useNative, D_seconds){
    // If using native hours, a local "day" is D_seconds long but we still map it to 24 native hours
    // Hours per Earth-day is 24; native hours also use 24 divisions but each native hour length differs.
    const hours = 24 * frac;
    const totalSecondsIn24 = hours * 3600;
    // For native mode we still report hh:mm:ss across 24 divisions
    const h = Math.floor(hours);
    const m = Math.floor((hours - h) * 60);
    const s = Math.floor(((hours - h) * 60 - m) * 60);
    const msFrac = ((hours - h) * 60 * 60 - m * 60 - s);
    return {h, m, s, msFrac};
  }

  function update(){
    const t_ms = Date.now();
    const epochKey = epochSelect.value;
    const epoch_ms = EPOCHS[epochKey];
    const useNative = nativeToggle.checked;

    utcNowLabel.textContent = new Date(t_ms).toISOString().replace('T',' ').replace('Z',' UTC');

    BODIES.forEach(b=>{
      const {day_count, frac} = computeLocal(t_ms, epoch_ms, b.D);
      const hms = fracToHMS(frac, useNative, b.D);
      const timeEl = document.getElementById(b.id + '-time');
      const dayEl  = document.getElementById(b.id + '-day');
      const DEl    = document.getElementById(b.id + '-D');

      timeEl.textContent = `${pad(hms.h)}:${pad(hms.m)}:${pad(hms.s)}`;
      dayEl.textContent  = `day ${day_count}`;
      DEl.textContent    = `D=${(b.D/3600).toFixed(3)}h`;
    });
  }

  // Start live updates
  update();
  // Smooth animation: aim ~200ms update
  setInterval(update, 200);

  // Allow clicking a tile to toggle native hours for that planet only
  grid.addEventListener('click', (ev)=>{
    const tile = ev.target.closest('.tile');
    if(!tile) return;
    const id = tile.id.replace('tile-','');
    // toggle native toggle to the opposite (global)
    nativeToggle.checked = !nativeToggle.checked;
    update();
  });

  </script>
</body>
</html>
